zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 2a86a62d5a4146d0ab1736f5424af785
      name: Templates/NRPE
  host_groups:
    - uuid: 2a86a62d5a4146d0ab1736f5424af785
      name: XenServer Hosts
  templates:
    - uuid: 9c561c7847ef42a5abd1c532f54167de
      template: 'Discover Hosts through NRPE Agent'
      name: XenServer Host Discovery Template
      groups:
        - name: XenServer Hosts
      discovery_rules:
        - uuid: 57a7c9f6f56644ba8f1f8d3991f9af3f
          name: XenServer Host Discovery
          type: TRAP
          key: xenapp.host.discovery
          delay: '0'
          lifetime_type: DELETE_NEVER
          lifetime: '0'
          enabled_lifetime_type: DISABLE_NEVER
          host_prototypes:
            - uuid: 454c435992414c2d92d1f26d9919dcb6
              host: '{#HOST.NAME}'
              name: '{#HOST.NAME}'
              inventory_mode: AUTOMATIC
              group_links:
                - group:
                    name: XenServer Hosts
              templates:
                - name: 'NRPE Checks by Zabbix Proxy'
              custom_interfaces: 'YES'
              interfaces:
                - ip: '{#HOST.IP}'
                - interface_ref: if1
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.data
      macros:
        - macro: '{$IP.RANGE.MATCHES}'
          value: '10.62.7.0/24'
          description: 'Comma-separated list of IP ranges or addresses for XenServer discovery'
